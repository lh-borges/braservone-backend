# ========== PERFIL ==========
spring.profiles.active=prod

# ========== DataSource (PROD) ==========
# Usando o Cloud SQL Socket Factory (MySQL) com o nome da conexão
spring.datasource.url=jdbc:mysql://google/braserone?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC

# usuário e senha vêm do ambiente (Cloud Run: --set-env-vars=DB_USERNAME=...,DB_PASSWORD=...)
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}

# driver padrão do MySQL
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# propriedades específicas do socket factory do Cloud SQL
spring.datasource.hikari.data-source-properties.cloudSqlInstance=magnetic-runway-196419:southamerica-east1:braser-one
spring.datasource.hikari.data-source-properties.socketFactory=com.google.cloud.sql.mysql.SocketFactory
# se quiser forçar IPv4
# spring.datasource.hikari.data-source-properties.ipTypes=PUBLIC

# ========== Hikari (enxuto para Cloud Run) ==========
spring.datasource.hikari.minimum-idle=0
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.pool-name=CloudRunHikari

# ========== JPA (PROD) ==========
# se o schema já está criado, mantenha validate; se ainda não, troque para update
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.open-in-view=false

# ========== LOGGING ==========
logging.level.root=INFO
logging.level.org.springframework.security=WARN
# em Cloud Run o log vai pro stdout, mas não tem problema deixar isso
logging.file.name=logs/app-prod.log

# ========== JWT (PROD) ==========
bezkoder.app.jwtSecret=2rUq9G2y8y9jR9f3r1tJqYq6sV1v2b9A9X5n2HkZ0Rk=
bezkoder.app.jwtExpirationMs=86400000
bezkoder.app.jwtRefreshSecret=ZpP3rP2yS7zQ5wV1lK9mT8eR4cD2bH6nJ1uY3oP8qR0=
bezkoder.app.jwtRefreshExpirationMs=1209600000

# ========== SERVER (Cloud Run) ==========
server.port=${PORT:8080}
server.address=0.0.0.0
